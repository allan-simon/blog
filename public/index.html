<!DOCTYPE html>
<html lang="en-us">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.15" />
    <title>Allan&#39;s blog</title>
    
    
    
    <meta name="description" content="" />
    <meta name="keywords" content='linux,architect,python,rust,php,rest' />
    
    
    <link href="http://allan-simon.github.io/blog/index.xml" rel="alternate" type="application/rss+xml" title="Allan&#39;s blog" />
    <link rel="stylesheet" href="http://allan-simon.github.io/blog//css/bootstrap.min.css" />
    <link rel="stylesheet" href="http://allan-simon.github.io/blog//css/highlightjs-themes/androidstudio.css" />
    <link rel="stylesheet" href="http://allan-simon.github.io/blog//css/font-awesome.min.css" />
    <link rel="stylesheet" href="http://allan-simon.github.io/blog//css/phlat.css" />
</head>

    <body>
        <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Allan&#39;s blog</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                
            </ul>
        </div>
    </div>
</nav>

        <div id="top" class="container">
            <div class="row" id="content-main">
                <div class="col-md-8">
                    
                    
                        <div class="row">
                            <div class="col-md-12 content-card">
                                <h1><a href="http://allan-simon.github.io/blog/posts/alembic-use-sql-statement-instead-of-sqlalchemy/">alembic use sql statement instead of sqlalchemy</a></h1>
                                <ul class="list-inline">
                                    <li><i class="fa fa-calendar"></i>April 3, 2016</li>
                                    <li><i class="fa fa-user"></i></li>
                                </ul>
                                <p>I know it&rsquo;s pretty popular to use the wonderful <code>sqlalchemy</code> ORM
for python, especially combined with <code>alembic</code>, but sometimes
you just want to type plain SQL request.</p>

<p>And actually it&rsquo;s pretty easy, after creating your migrations
just do:</p>

                                <a class="btn btn-custom" href="http://allan-simon.github.io/blog/posts/alembic-use-sql-statement-instead-of-sqlalchemy/" role="button">Read More</a>
                            </div>
                        </div>
                    
                        <div class="row">
                            <div class="col-md-12 content-card">
                                <h1><a href="http://allan-simon.github.io/blog/posts/python-alembic-with-environment-variables/">python alembic with environment variables</a></h1>
                                <ul class="list-inline">
                                    <li><i class="fa fa-calendar"></i>April 3, 2016</li>
                                    <li><i class="fa fa-user"></i></li>
                                </ul>
                                <p>At my job we&rsquo;re currently using <a href="http://alembic.readthedocs.org/">alembic</a>
to manage our database migrations (i.e adding a new table / index etc.)</p>

<p>The tool is pretty mature and has been here for a while, so it covers
a lot of advanced case (like handling several databases, having a tree
of migrations etc.) while still being simple for simple case</p>

<p>The only not straighforward thing I found was that it&rsquo;s not easy
to integrate with 12Factor-apps, i.e my code is running in a lot
of differents environments (vagrant+docker on my local machine,
the QA environments,  the pre-production, production etc.)</p>

                                <a class="btn btn-custom" href="http://allan-simon.github.io/blog/posts/python-alembic-with-environment-variables/" role="button">Read More</a>
                            </div>
                        </div>
                    
                        <div class="row">
                            <div class="col-md-12 content-card">
                                <h1><a href="http://allan-simon.github.io/blog/posts/how-to-sum-all-numbers-in-file-in-bash/">how to sum all numbers in file in bash</a></h1>
                                <ul class="list-inline">
                                    <li><i class="fa fa-calendar"></i>March 20, 2016</li>
                                    <li><i class="fa fa-user"></i></li>
                                </ul>
                                <h3 id="i-have-a-file-with-one-number-by-line-how-to-get-the-sum:764e3c47ee291b9ff48d57d25ed103c7">I have a file, with one number by line, how to get the sum</h3>

<pre><code class="language-bash">paste -s -d+  myfile_with_numbers | bc 
</code></pre>

<p>and if you have a csv, delimited by <code>,</code> and for which the number is on
the 2nd field:</p>

<pre><code>cut -d,  my_file.csv -f 2 | paste -s -d+  | bc 
</code></pre>

                                <a class="btn btn-custom" href="http://allan-simon.github.io/blog/posts/how-to-sum-all-numbers-in-file-in-bash/" role="button">Read More</a>
                            </div>
                        </div>
                    
                        <div class="row">
                            <div class="col-md-12 content-card">
                                <h1><a href="http://allan-simon.github.io/blog/posts/murmur_hash_v3_in_mysql_utf8_compatible/">murmur hash v3 in MySQL utf8 compatible</a></h1>
                                <ul class="list-inline">
                                    <li><i class="fa fa-calendar"></i>March 20, 2016</li>
                                    <li><i class="fa fa-user"></i></li>
                                </ul>
                                <h1 id="murmur-hash-v3-in-mysql-utf8-compatible:905a344dd7cee3e2417a03c311b84a02">Murmur hash v3 in MySQL utf8 compatible</h1>

<p>These days for performance purpose, I needed to replace some <code>autoincrement</code> Id
by a hash calculated one, in order to have a determinist way to retrieve from
an object, it&rsquo;s record in database, and easily recognize duplicate.</p>

<p>For that I have chosen the <a href="https://en.wikipedia.org/wiki/MurmurHash">murmur hash v3 function</a></p>

<p>For new records, I could use the python module (leveraging C code) <a href="https://pypi.python.org/pypi/mmh3/2.3.1">mmh3</a></p>

<p>But as I needed to update million of existing record, I couldn&rsquo;t possibly
imagine doing that by calling a python script.</p>

                                <a class="btn btn-custom" href="http://allan-simon.github.io/blog/posts/murmur_hash_v3_in_mysql_utf8_compatible/" role="button">Read More</a>
                            </div>
                        </div>
                    
                        <div class="row">
                            <div class="col-md-12 content-card">
                                <h1><a href="http://allan-simon.github.io/blog/posts/bug-in-vagrant-virtualbox-sharefolder/">bug in Vagrant with Virtualbox sharefolder</a></h1>
                                <ul class="list-inline">
                                    <li><i class="fa fa-calendar"></i>August 23, 2015</li>
                                    <li><i class="fa fa-user"></i></li>
                                </ul>
                                <h2 id="the-problem-serving-static-files:841a2f7d6b52b26d6728896000405247">The problem: serving static files</h2>

<p>The problem will affect you if you try to serve static files
from your vagrant folder if you use the default from virtualbox</p>

<p>For example you got your nginx or apache to serve css files
and when you update them, they don&rsquo;t get updated, and sometimes
they even come out with some garbage bytes at the end of it</p>

                                <a class="btn btn-custom" href="http://allan-simon.github.io/blog/posts/bug-in-vagrant-virtualbox-sharefolder/" role="button">Read More</a>
                            </div>
                        </div>
                    
                        <div class="row">
                            <div class="col-md-12 content-card">
                                <h1><a href="http://allan-simon.github.io/blog/posts/create-a-rest-api-with-symfony2-part2-entity-migration/">create a rest api with symfony2 Part 2: Entity,  DB Migration, CRUD</a></h1>
                                <ul class="list-inline">
                                    <li><i class="fa fa-calendar"></i>May 24, 2015</li>
                                    <li><i class="fa fa-user"></i></li>
                                </ul>
                                <p><strong>Update 23 November 2015</strong>: Corrected some typo, and updated bundles versions for Doctrine</p>

<p>In the <a href="http://allan-simon.github.io/blog/posts/create-a-rest-api-with-symfony2/">first part</a> we&rsquo;ve seen how to
create the base of a symfony2 project used to generate a REST Api.</p>

<p>In this part we&rsquo;re going to see</p>

<ul>
<li>How to use the basics of JMSSerializer to serialize Entity objects</li>
<li>How to link our API with a database</li>
<li>How to create migration files to easily manage our datase over time and colleagues</li>
<li>and how to generate a full <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD (create/read/update/delete)</a> with form checking</li>
</ul>

                                <a class="btn btn-custom" href="http://allan-simon.github.io/blog/posts/create-a-rest-api-with-symfony2-part2-entity-migration/" role="button">Read More</a>
                            </div>
                        </div>
                    
                        <div class="row">
                            <div class="col-md-12 content-card">
                                <h1><a href="http://allan-simon.github.io/blog/posts/create-a-rest-api-with-symfony2/">Create a production ready rest api with symfony2 (part 1)</a></h1>
                                <ul class="list-inline">
                                    <li><i class="fa fa-calendar"></i>May 23, 2015</li>
                                    <li><i class="fa fa-user"></i></li>
                                </ul>
                                <p>What will we cover:</p>

<ul>
<li>how to transform a just-started symfony project into a REST-ready project</li>
<li>how to configure and use the FOSRestBundle to help us in that task</li>
<li>How to use Doctrine migrations to easily transition your database from version N to version N+1</li>
<li>how to add functionnal tests to automatically check your API</li>
<li>how to configure and use the JMSSerializer to automagically serialize and unseralize your data into json (or xml)</li>
<li>How to plug your API to a Oauth2 service</li>
<li>mixed in between some generic advices to make your API reality proof</li>
<li>practical examples of common &ldquo;tricky things&rdquo; (Image uploading / pagination / association between resources etc.)</li>
</ul>

<p>Here we suppose you&rsquo;re already familiar with what a REST API <strong>exactly</strong> means,
and I really mean the emphasis in <strong>exactly</strong></p>

<p>for this I urge you to read these links:</p>

<ul>
<li><a href="http://martinfowler.com/articles/richardsonMaturityModel.html">http://martinfowler.com/articles/richardsonMaturityModel.html</a></li>

<li><p><a href="http://blog.steveklabnik.com/posts/2011-07-03-nobody-understands-rest-or-http">http://blog.steveklabnik.com/posts/2011-07-03-nobody-understands-rest-or-http</a></p></li>

<li><p><a href="https://github.com/interagent/http-api-design">https://github.com/interagent/http-api-design</a></p></li>

<li><p><a href="www.vinaysahni.com/best-practices-for-a-pragmatic-restful-api">www.vinaysahni.com/best-practices-for-a-pragmatic-restful-api</a></p></li>
</ul>

<p>An API is made to resist the test of time, so you can really afford to spend one or
two hours to carefully read these links.</p>

<h3 id="example-project:a54943db4d72a4144ed4e4c7803550cc">Example project</h3>

<p>All the steps described here are applied in this toy project
<a href="https://github.com/allan-simon/symfony2-rest-api-example">https://github.com/allan-simon/symfony2-rest-api-example</a></p>

<p>It&rsquo;s a Blog-like services with a REST API in json at the end it will permit</p>

<ul>
<li>Multiple Authors</li>
<li>Possiblity to add/edit/delete articles</li>
<li>Possibility to comments</li>
<li>Creation of tags to category articles</li>
</ul>

                                <a class="btn btn-custom" href="http://allan-simon.github.io/blog/posts/create-a-rest-api-with-symfony2/" role="button">Read More</a>
                            </div>
                        </div>
                    
                        <div class="row">
                            <div class="col-md-12 content-card">
                                <h1><a href="http://allan-simon.github.io/blog/posts/things-i-ve-learn-this-week/">Things I&#39;ve learn this week</a></h1>
                                <ul class="list-inline">
                                    <li><i class="fa fa-calendar"></i>May 12, 2015</li>
                                    <li><i class="fa fa-user"></i></li>
                                </ul>
                                <p>More than often I find myself trying to remember how did i solve that very one problem I thought I would have to solve only once, so I decided to start writing their solution here:</p>

<pre><code>* How to reload PHP-fpm without restarting it
* How to send the unchanged Host header to proxied server with Nginx
</code></pre>

                                <a class="btn btn-custom" href="http://allan-simon.github.io/blog/posts/things-i-ve-learn-this-week/" role="button">Read More</a>
                            </div>
                        </div>
                    
                        <div class="row">
                            <div class="col-md-12 content-card">
                                <h1><a href="http://allan-simon.github.io/blog/posts/vagrant-with-ansible-provisionning-docker-containers-for-symfony2/">vagrant with ansible provisionning docker containers for symfony2</a></h1>
                                <ul class="list-inline">
                                    <li><i class="fa fa-calendar"></i>April 12, 2015</li>
                                    <li><i class="fa fa-user"></i></li>
                                </ul>
                                <p>In this article we&rsquo;re going to cover:</p>

<ul>
<li>How to use ansible+docker+vagrant to create a one size for all environment for Symfony2 + Nginx + Postgresql + PHP-fpm</li>
<li>How to transition an existing application to fit in that new environment</li>
</ul>

<p>This article take the assumption that you have already heard about all the technologies above without being too familiar with them.</p>

<p>As an example will take the existing Oauth2 server I have created: <a href="https://github.com/allan-simon/oauth2-symfony2-vagrant-fosuserbundle">Oauth2Symfony2</a></p>

                                <a class="btn btn-custom" href="http://allan-simon.github.io/blog/posts/vagrant-with-ansible-provisionning-docker-containers-for-symfony2/" role="button">Read More</a>
                            </div>
                        </div>
                    
                        <div class="row">
                            <div class="col-md-12 content-card">
                                <h1><a href="http://allan-simon.github.io/blog/posts/doctrine2-order-by-count-many-to-many/">doctrine2 order by count many to many</a></h1>
                                <ul class="list-inline">
                                    <li><i class="fa fa-calendar"></i>April 9, 2015</li>
                                    <li><i class="fa fa-user"></i></li>
                                </ul>
                                <p>Today I found a problem quite common but tricky enough for the solution
to share it with you</p>

<h3 id="the-problem:fcd569fc48e65a7020df74b8509a5751">The problem</h3>

<p>I have 2 Entities</p>

<ul>
<li>User</li>
<li>Article</li>
</ul>

<p>and a &ldquo;likedByUsers&rdquo; Many To Many relationship between both</p>

<p>Now I would like to get the Articles ordered by number of &lsquo;likes&rsquo;
for an API call returning a list of Articles</p>

<p>if you feel smart you can try to find the solution by yourself
it&rsquo;s an interesting exercise about &lsquo;how much do you know doctrine and SQL&rsquo;</p>

<p>but let me tell you, the solution is like an Egg of Columbus, once you see
it it becomes evident, but it was actually not that simple at first.</p>

<h3 id="the-solution:fcd569fc48e65a7020df74b8509a5751">The solution</h3>

                                <a class="btn btn-custom" href="http://allan-simon.github.io/blog/posts/doctrine2-order-by-count-many-to-many/" role="button">Read More</a>
                            </div>
                        </div>
                    
                    
    <div class="row">
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-4" style="text-align: left; padding-left: 0px">
                    
                </div>
                <div class="col-md-4 col-md-offset-4" style="text-align: right; padding-right: 0px">
                    
                        <a class="btn btn-default" href="/page/2/" role="button" style="border-radius: 0px; display: block">Older</a>
                    
                </div>
            </div>
        </div>
    </div>


                </div>
                <div class="col-md-4">
                    <div class="row">
    <div class="col-md-11 col-md-offset-1 card">
        <h5>Search</h5>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
            <div class="input-group">
                <input class="form-control" type="search" name="q" />
                <span class="input-group-btn">
                    <button class="btn btn-custom" type="submit"><span class="glyphicon glyphicon-search"></span></button>
                </span>
            </div>
            <input type="hidden" name="q" value="site:http://allan-simon.github.io/blog/">
        </form>
    </div>
</div>

                    <div class="row">
    <div class="col-md-11 col-md-offset-1 card">
        <h5>Recent Posts</h5>
        <ul class="list-unstyled posts-recent">
            
        </ul>
    </div>
</div>

                    
    
        <div class="row">
            <div class="col-md-11 col-md-offset-1 card">
                <h5>categories</h5>
                <ul class="list-unstyled posts-recent">
                    
                </ul>
            </div>
        </div>
    

    


                </div>
            </div>
        </div>
        <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-xs-6">
    <ul class="list-inline links">
        
    </ul>
</div>

            <div class="col-md-4 col-xs-6">
    <ul class="list-inline social-media">
        
        
        
        
        
        
        
        
        
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-md-12">
                <p>
                    <a href="https://github.com/nraboy/hugo-phlat-theme">Phlat Theme</a> designed and built by <a href="http://www.nraboy.com">Nic Raboy</a> in San Francisco, California.
                </p>
            </div>
        </div>
    </div>
</footer>

        <div id="back-to-top" class="hidden">
    <a href="#top" class="well well-sm" onclick="$('html,body').animate({scrollTop:0},'slow');return false;">
        <i class="glyphicon glyphicon-chevron-up"></i> Back to Top
    </a>
</div>
<script src="http://allan-simon.github.io/blog//js/jquery-2.2.1.min.js"></script>
<script src="http://allan-simon.github.io/blog//js/bootstrap.min.js"></script>
<script src="http://allan-simon.github.io/blog//js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>
    if(($(window).height() + 100) < $(document).height()) {
        $('#back-to-top').removeClass('hidden').affix({
            offset: {
                top: 100
            }
        });
    }
</script>

    



    </body>
</html>
