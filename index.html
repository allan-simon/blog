<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> Allan&#39;s blog &middot; Allan&#39;s blog </title>

  
  <link rel="stylesheet" href="http://allan-simon.github.io/blog/css/poole.css">
  <link rel="stylesheet" href="http://allan-simon.github.io/blog/css/syntax.css">
  <link rel="stylesheet" href="http://allan-simon.github.io/blog/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.ico">

  
  <link href="http://allan-simon.github.io/blog/index.xml/" rel="alternate" type="application/rss+xml" title="Allan&#39;s blog" />
</head>

<body>

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>Allan&#39;s blog</h1>
      <p class="lead">
       Tips, tricks and random thoughts on Linux/Vim/rust/php/devops 
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/blog/">Home</a> </li>
      
    </ul>

    <p>Â© Creative-Common attribution</p>
  </div>
</div>


    <div class="content container">
<div class="posts">

      
  <div class="post">
    <h1 class="post-title">
      <a href="http://allan-simon.github.io/blog/posts/functionnal-tests-symfony2-and-authentication/">
        Functionnal tests in symfony2 with authentication
      </a>
    </h1>

    <span class="post-date">Fri, Feb 20, 2015</span>

    <p>Let&rsquo;s say you have your symfony2 website, all setup correctly with its
set of functionnal tests using phpunit, and now you start to have
pages that only authenticated users can access to. My first solution was to
create a client, make it load the login form, submit some valid credentials
and then load the actual page to test. It was working fine as the client
has a storage for cookie, it is acting like an actual browser in that case.</p>

<p>The problem was that the time to execute the test was much longer, which
started to become a problem has the test suite was growing.</p>

<p>The first trick is to follow them method adviced by symfony, which is for the
test environnement to enable the HTTP Basic Authentication method. For those
who doesn&rsquo;t know, the HTTP standard comme with a method to authentify a
user-agent by directly sending the username/password in the HTTP header
(which goes along the fact that HTTP is aimed to be stateless)</p>

<p>in your <code>config_test.yml</code> add this (replace <code>NAME_OF_YOUR_FIREWALL</code>)</p>

<pre><code>security:
    firewalls:
        NAME_OF_YOUR_FIREWALL:
            http_basic: ~
</code></pre>

<p>The second trick, to not have to repeat the username/password in all your
functionnal tests, is to use the <a href="https://github.com/liip/LiipFunctionalTestBundle">LiipFunctionnalBundle</a>
follow the installation instruction and then make your functionnal test inherit
from their class, like this</p>

<pre><code>&lt;?php
//...
use Liip\FunctionalTestBundle\Test\WebTestCase;

class YourTest extends WebTestCase
{
 // your code
}
</code></pre>

<p>then you can precise in <code>config_test.yml</code> your credentials:</p>

<pre><code>liip_functional_test:
    authentication:
        username: &quot;XXXXX&quot;
        password: &quot;YYYYY&quot;
</code></pre>

<p>finally to create an authenticated client, use this method</p>

<pre><code>&lt;?php
//...
use Liip\FunctionalTestBundle\Test\WebTestCase;

class YourTest extends WebTestCase
{
    public testYourFeature()
    {
        // true = &quot;authenticated&quot;
        $client static::makeClient(true);
        // ...
    }
}
</code></pre>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://allan-simon.github.io/blog/posts/solve-composer-github-api-limitation/">
        Solve composer github api limitation
      </a>
    </h1>

    <span class="post-date">Tue, Feb 10, 2015</span>

    

<h3 id="toc_0">Could not fetch X enter your GitHub credentials to go over the API rate limit</h3>

<p>The problem is that composer is retrieving nearly all the packages from github
using the anonymous access github API. In order to solve it you need to generate
a token</p>

<ol>
<li>you need a github account (or ask a friend)</li>
<li>go on your setting page <a href="https://github.com/settings/applications">here</a></li>
<li>click on <code>Generate new token</code></li>
</ol>

<p>now two possibilities</p>

<h4 id="toc_1">1 - Put this token in one specific project</h4>

<p>for this simply run</p>

<pre><code>composer config -g github-oauth.github.com YOUR_TOKEN
</code></pre>

<p>or</p>

<pre><code>php composer.phar config -g github-oauth.github.com YOUR_TOKEN
</code></pre>

<p>(depending on how you installed composer)</p>

<p>it will add that to your project&rsquo;s composer.json file</p>

<h4 id="toc_2">2 -  Put this token in your global composer configuration</h4>

<p>If your project is an open-source or company project you may not want
to commit your token on the git of your project/company</p>

<p>for this edit the file <code>~/.composer/config.json</code> and put in it:</p>

<pre><code>{
    &quot;config&quot;: {
        &quot;github-oauth&quot;: { &quot;github.com&quot;: &quot;YOUR_TOKEN&quot; }
    }
}
</code></pre>

<p>that&rsquo;s all folks!</p>

<p>Source:</p>

<ul>
<li><a href="https://coderwall.com/p/kz4egw/composer-install-github-rate-limiting-work-around">coderwall.com</a></li>
<li><a href="https://github.com/composer/composer/issues/3542">composer&rsquo;s github</a></li>
<li><a href="https://github.com/blog/1509-personal-api-tokens">github&rsquo;s blog</a> More details about Github token</li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://allan-simon.github.io/blog/posts/install-docker-on-ubuntu-12.04/">
        Install docker on ubuntu 12.04
      </a>
    </h1>

    <span class="post-date">Tue, Feb 10, 2015</span>

    <p>This article is a shameless summary from <a href="http://compositecode.com/2013/11/11/getting-docker-installed-on-ubuntu-12-04-lts/">http://compositecode.com</a></p>

<p>the steps are:</p>

<ul>
<li>Updating your kernel to 3.8+ (requires a reboot)</li>
<li>Add the docker repository</li>
<li>Installing the package</li>
</ul>

<pre><code>sudo apt-get install linux-image-generic-lts-raring linux-headers-generic-lts-raring
sudo reboot
sudo sh -c &quot;wget -qO- https://get.docker.io/gpg | apt-key add -&quot;
sudo sh -c &quot;echo deb http://get.docker.io/ubuntu docker main &gt; /etc/apt/sources.list.d/docker.list&quot;
sudo apt-get update
sudo apt-get install lxc-docker
</code></pre>

<p>And now you should be able to get docker working</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://allan-simon.github.io/blog/posts/postgresql-display-one-column-per-line/">
        postgresql display one column per line
      </a>
    </h1>

    <span class="post-date">Tue, Feb 10, 2015</span>

    

<h3 id="toc_0">Problem : displaying a table with a lot of columns</h3>

<p>You always got that table with a dozens of columns of type text and for which
the normal tabular output does not work nicely and you end up with something
like</p>

<pre><code> articleid | plop | pouet | prout | tagada |  id   | newsid  | newstype |                                                          title                                                          | something | something | something | something | something | something | something | something |      something       |      something       | something | something | something | something |          something          |    something    |                                                                                                                                                                                                                                                                                                                 something                                                                                                                                                                                                                                                                                                                 |            something            
-----------+-------+-------+-------+-------+-------+---------+----------+-----------------------------------------------------------------------------------------------------------------------------+------------+-------------+-----------+------------+-----------------+---------+--------------+---------+---------------------+---------------------+---------------+-------------+-----------+------------+---------------------------+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+------------+--------------------------------+--------------+----------------------+------------------------------------------------------------------------------------+--------------+-----------+----------+----------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------+-----------+-------+------------
   1000163 |     0 |     0 |     0 |     0 |   141 | 1000147 |       10 | blablabla                                                                                           |          3 |           4 |        22 |    1000163 |               0 | 1000163 |          184 |   10028 | 2014-06-30 23:36:00 | 2014-06-30 23:36:00 |             0 |           0 |         0 |          0 |                           |           |          
</code></pre>

<h3 id="toc_1">In MySQL</h3>

<p>with MySQL you can replace <code>;</code> by <code>\G</code> at the end of your SQL statement, i.e turning</p>

<pre><code>SELECT * FROM example ;
</code></pre>

<p>into</p>

<pre><code>SELECT * FROM example \G
</code></pre>

<h3 id="toc_2">In PostgreSQL</h3>

<p>you need first to use <code>\x</code> and it will activate the &lsquo;one column by line&rsquo; display
(use <code>\x</code> again to switch back to normal mode)</p>

<pre><code>\x
SELECT * FROM example;
\x
</code></pre>

<p>and you will something like that</p>

<pre><code>-[ RECORD 1 ]------
articleid | 1000000
something     | 0
something     | 0
something     | 0
something     | 0
id        | 1
-[ RECORD 2 ]------
articleid | 1000002
something     | 0
something     | 0
something     | 0
something     | 0
something     | 2
</code></pre>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://allan-simon.github.io/blog/posts/first/">
        A new Blog this time on github and statically generated
      </a>
    </h1>

    <span class="post-date">Mon, Feb 9, 2015</span>

    <p>It has been a long time since I last did a blog the biggest reason behind were:</p>

<ul>
<li>it&rsquo;s hard to maintain a server and a blog platform</li>
<li>most common web plateforms are blocked in China</li>
<li>the other plateforms does not fit my geeky needs</li>
<li>non-self hosted platform make it hard to have easy backup of your data</li>
</ul>

<p>So here we are, after reading comments on HackerNews I&rsquo;ve found the project
<a href="http://gohugo.io">Hugo</a> which permits you to create a static blog the
advantages I see to it</p>

<ul>
<li>it&rsquo;s all command line and simple to install</li>
<li>vim and markdown friendly, posting is just one more markdown file</li>
<li>can be hosted on github (which solve the hosting problem)</li>
<li>it&rsquo;s text files and git (which solve the backup problem)</li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://allan-simon.github.io/blog/about/">
        about
      </a>
    </h1>

    <span class="post-date">Mon, Feb 9, 2015</span>

    

<h2 id="toc_0">What will you find on this blog</h2>

<ul>
<li>My daily discoveries and tips, mostly web/linux/devops/c++/c/rust related.</li>
<li>Some tips and tricks on how to survive in the Chinese internet as a devops</li>
<li>Some news concerning my personnal projects</li>
<li>Random thoughts as I progress in my professional and personnal career.</li>
</ul>

  </div>
  
</div>
</div>

  </body>
</html>
